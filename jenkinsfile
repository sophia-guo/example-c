pipeline {
    agent { label 'ub14x64rt2-1' }
	stages {
	    stage('Build') {
            steps {
                echo 'Building..'
            }
        }
	    stage('Test') {
	      steps {
	        sh '''
	        gcc -Wall -fprofile-arcs -ftest-coverage hello.c -o hello
			./hello
			gcov hello.c
			'''
	      }
	    }
	}
	post {
        always {
          sh "curl -s https://codecov.io/bash | bash -s - -t 397a0b37-aacb-407c-a194-a5ba3f353f4e || echo 'Codecov did not collect coverage reports'"
          cleanWs()
        }
    }
}
